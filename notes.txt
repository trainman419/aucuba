Potential bugs:
 - conditionals may not be re-evaluated if the preceding choice changes
   variables.
